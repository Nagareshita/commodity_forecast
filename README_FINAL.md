# Commodity Price Forecasting Tool (修正版)

CSV形式の価格データから将来価格を予測する学術的ツール

## 🔧 修正内容

### 問題点と解決

1. **予測が異常に高かった問題**
   - 原因: データ頻度（月次/日次）の誤認識
   - 解決: 自動頻度検出機能を実装
   
2. **日本語の文字化け**
   - 原因: 適切なフォントが見つからない
   - 解決: 複数のフォントをフォールバックで試行

### 予測ロジックの正確性

**学術的に正しい実装:**
- Geometric Brownian Motion (GBM)
  - dS = μS dt + σS dW
  - 離散化: S(t) = S(t-1) × exp((μ - σ²/2)Δt + σ√Δt ε)
- ARIMA (1,1,1) でトレンド補正
- Combined Model: 70% 過去トレンド + 30% ARIMAトレンド

**年率換算の正しい方法:**
```
期間リターン → 年率リターン: μ_annual = μ_period × periods_per_year
期間ボラティリティ → 年率: σ_annual = σ_period × √periods_per_year
```

**検証結果（sample_data.csvで）:**
- 過去25年のトレンド: 年平均 2.47% 成長 (1.84倍)
- 10年予測: 年平均 2.45% 成長 (1.27倍)  ✅ 一致！

## インストール

```bash
pip install pandas numpy matplotlib statsmodels scipy pyside6
```

## 使い方

### 1. アプリケーション起動

```bash
python commodity_forecast.py
```

### 2. CSVデータ形式

```csv
Date,Price
2000-01-01,1000.00
2000-02-01,1050.50
...
```

- **Date**: YYYY-MM-DD形式
- **Price**: JPY/kg単位
- **頻度**: 月次・週次・日次を自動検出

### 3. サンプルデータ

`sample_data.csv` - 現実的な銅価格データ（25年分、月次）
- 年平均成長率: 2.47%
- 年率ボラティリティ: 21.64%

## 予測手法

### Combined Model

1. **過去データの統計分析**
   - 対数リターンの平均・標準偏差を計算
   - データ頻度を自動検出して年率換算

2. **ARIMA (1,1,1)**
   - 短期トレンドを抽出
   - 過度な外挿を防ぐ

3. **Geometric Brownian Motion**
   - 価格変動をモデル化
   - 対数正規分布に従う

4. **Monte Carlo Simulation**
   - 1000回シミュレーション
   - 90%信頼区間を算出

### 重み付け

`最終μ = 0.7 × 過去μ + 0.3 × ARIMAμ`

## 注意事項

### 予測の解釈

- **短期（5年）**: 比較的信頼できる
- **中期（10年）**: 不確実性が増加
- **長期（30年）**: 参考程度

### 制限事項

- 過去のパターンが将来も続く前提
- 市場の構造変化は考慮されない
- ブラックスワンイベントは含まれない

⚠️ **投資判断には使用しないでください**

## システム要件

- Python 3.8以上
- 2GB以上のメモリ
- Windows/Mac/Linux

## ファイル

- `commodity_forecast.py` - メインアプリ (24KB)
- `sample_data.csv` - サンプルデータ (5.4KB)
- `README.md` - このファイル

## ライセンス

教育・研究目的での使用を想定
